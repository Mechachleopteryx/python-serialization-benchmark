<html>
<head>
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body>
<div class="container">
<h1>Python Serialization Benchmark</h1>
<p>This <a href="http://github.com/voidfiles/python-serialization-benchmark">repository</a> maintains a set of benchmarks for python serialization frameworks.</p>
<p>You can find the latest benchmarks on <a href="https://voidfiles.github.io/python-serialization-benchmark/">this page</a>.</p>
<p>Currently the following projects are benchmarked.</p>
<ul>
<li><a href="http://www.django-rest-framework.org/">Django REST Framework</a></li>
<li><a href="http://serpy.readthedocs.io/">serpy</a></li>
<li><a href="https://marshmallow.readthedocs.io/en/latest/">Marshmallow</a></li>
<li><a href="https://github.com/voidfiles/strainer">Strainer</a></li>
<li><a href="http://lollipop.readthedocs.io/en/latest/">Lollipop</a></li>
<li><a href="http://kim.readthedocs.io/en/latest/">Kim</a></li>
<li><a href="https://github.com/lyft/toasted-marshmallow">Toasted Marshmallow</a></li>
<li><a href="https://docs.pylonsproject.org/projects/colander/en/latest/">Colander</a></li>
<li><a href="https://github.com/b6d/lima/">Lima</a></li>
<li><a href="https://avro.apache.org/">Avro</a></li>
</ul>
<p>Along with a baseline custom function that doesn't use a framework.</p>
<h2>Running the test suite</h2>
<p>A Docker container is bundled with the repository which you can use to run the benchmarks. Firstly make sure you have Docker installed.</p>
<ol>
<li>
<p>Install Docker</p>
</li>
<li>
<p>Build the container <code>$ docker-compose build</code></p>
</li>
<li>
<p>Run the tests. <code>$ docker-compose run --rm tests</code></p>
</li>
</ol>
<pre><code>Library                  Many Objects (seconds)    One Object (seconds)    Relative
---------------------  ------------------------  ----------------------  ----------
Custom                                0.0106766              0.00519919     1
lima                                  0.0125217              0.00629926     1.18551
Pickle                                0.0173957              0.0172369      2.18147
serpy                                 0.0332184              0.0176816      3.20613
Strainer                              0.0534034              0.0266812      5.04444
Toasted Marshmallow                   0.0825396              0.0447464      8.0176
Colander                              0.215784               0.105959      20.2662
Lollipop                              0.301132               0.143556      28.0104
Avro                                  0.413466               0.207327      39.1031
Marshmallow                           0.446715               0.22695       42.4334
kim                                   0.629416               0.311557      59.2709
Django REST Framework                 0.781569               0.577704      85.6191
</code></pre>

<h2>The Benchmark</h2>
<p>Each framework is asked to serialize a list of 2 objects a 1000 times, and then 1 object a 1000 times.</p>
<p>This is the current object that is being serialized.</p>
<pre><code class="python">class ChildTestObject(object):
    def __init__(self, multiplier=None):
        self.w = 1000 * multiplier if multiplier else 100
        self.x = 20 * multiplier if multiplier else 20
        self.y = 'hello' * multiplier if multiplier else 'hello'
        self.z = 10 * multiplier if multiplier else 10


class ParentTestObject(object):
    def __init__(self):
        self.foo = 'bar'
        self.sub = ChildTestObject()
        self.subs = [ChildTestObject(i) for i in xrange(10)]

    def bar(self):
        return 5

benchmark_object = ParentTestObject()
</code></pre>

<h2>Discussion</h2>
<p>Serialization from python objects to JSON, XML, or other transmission formats is a common task for many web related projects. In order to fill that need a number of frameworks have arised. While their aims are similar, they don't all share the same attributes. Here are how some of the features comapre.</p>
<table class="table">
  <thead>
    <tr>
        <td>Project</td>
        <td>Serialization</td>
        <td>Encoding</td>
        <td>Deserialization</td>
        <td>Validation</td>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="http://www.django-rest-framework.org/">Django REST Framework</a></td>
      <td><a href="http://www.django-rest-framework.org/api-guide/serializers/">Yes</a></td>
      <td><a href="http://www.django-rest-framework.org/api-guide/renderers/">Yes</a></td>
      <td><a href="http://www.django-rest-framework.org/api-guide/validators/">Yes</a></td>
      <td><a href="http://www.django-rest-framework.org/api-guide/validators/">Yes</a></td>
    </tr>
    <tr>
      <td><a href="http://serpy.readthedocs.io/">serpy</a></td>
      <td><a href="http://serpy.readthedocs.io/en/latest/#examples">Yes</a></td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/">Marshmallow</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#serializing-objects-dumping">Yes</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#serializing-objects-dumping">Yes</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#deserializing-objects-loading">Yes</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#validation">Yes</a></td>
    </tr>
    <tr>
      <td><a href="https://github.com/maximkulkin/lollipop">Lollipop</a></td>
      <td><a href="http://lollipop.readthedocs.io/en/latest/quickstart.html#serializing-data">Yes</a></td>
      <td>No</td>
      <td><a href="http://lollipop.readthedocs.io/en/latest/quickstart.html#deserializing-data">Yes</a></td>
      <td><a href="http://lollipop.readthedocs.io/en/latest/quickstart.html#validation">Yes</a></td>
    </tr>
    <tr>
      <td><a href="https://github.com/voidfiles/strainer">Strainer</a></td>
      <td><a href="https://github.com/voidfiles/strainer#serialization-example">Yes</a></td>
      <td>No</td>
      <td><a href="https://github.com/voidfiles/strainer#validation">Yes</a></td>
      <td><a href="https://github.com/voidfiles/strainer#validation">Yes</a></td>
    </tr>
    <tr>
      <td><a href="http://kim.readthedocs.io/en/latest/">Kim</a></td>
      <td><a href="http://kim.readthedocs.io/en/latest/user/quickstart.html#serializing-data">Yes</a></td>
      <td>No</td>
      <td><a href="http://kim.readthedocs.io/en/latest/user/quickstart.html#marshaling-data">Yes</a></td>
      <td><a href="http://kim.readthedocs.io/en/latest/user/quickstart.html#handling-validation-errors">Yes</a></td>
    </tr>
    <tr>
      <td><a href="https://github.com/lyft/toasted-marshmallow">Toasted Marshmallow</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#serializing-objects-dumping">Yes</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#serializing-objects-dumping">Yes</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#deserializing-objects-loading">Yes</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#validation">Yes</a></td>
    </tr>
    <tr>
      <td><a href="https://docs.pylonsproject.org/projects/colander/en/latest/">Colander</a></td>
      <td><a href="https://docs.pylonsproject.org/projects/colander/en/latest/basics.html#serialization">Yes</a></td>
      <td>No</td>
      <td><a href="https://docs.pylonsproject.org/projects/colander/en/latest/basics.html#deserialization">Yes<<a></td>
      <td><a href="https://docs.pylonsproject.org/projects/colander/en/latest/basics.html#defining-a-colander-schema">Yes</a></td>
    </tr>
    <tr>
      <td><a href="https://lima.readthedocs.io/en/latest/index.html">Lima</a></td>
      <td><a href="https://lima.readthedocs.io/en/latest/index.html">Yes</a></td>
      <td>No</td>
      <td>No</td>
      <td><a ref="https://lima.readthedocs.io/en/latest/fields.html#data-validation">No</a></td>
    </tr>
    <tr>
      <td><a href="http://avro.apache.org/docs/current/gettingstartedpython.html">Avro</a></td>
      <td><a href="http://avro.apache.org/docs/current/gettingstartedpython.html">Yes</a></td>
      <td><a href="http://avro.apache.org/docs/current/gettingstartedpython.html">Yes</a></td>
      <td><a href="http://avro.apache.org/docs/current/gettingstartedpython.html">Yes</a></td>
      <td>No</td>
    </tr>
  </tbody>
</table>

<ul>
<li><strong>Serialization</strong>: Does the framework provide a way of serializing python objects to simple datastructures</li>
<li><strong>Encoding</strong>: Does the framework provide a way of encoding data into a wire format</li>
<li><strong>Deserialization</strong>: Does the framework provide a way of deserializing simple data structures into complex data structures</li>
<li><strong>Validation</strong>: Does the framework provide a way of validating datastructures, and reprorting error conditions</li>
<li><strong>Part of Framework</strong>: Is serialization apart of a larger framework</li>
</ul></div>
</body>
</html>
